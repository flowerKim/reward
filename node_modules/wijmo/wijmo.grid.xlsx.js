/*
    *
    * Wijmo Library 5.20181.462
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
"use strict";function tryGetModuleWijmoGridDetail(){var e,o;return(e=window.wijmo)&&(o=e.grid)&&o.detail}function tryGetModuleWijmoGridMultirow(){var e,o;return(e=window.wijmo)&&(o=e.grid)&&o.multirow}var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)o.hasOwnProperty(l)&&(e[l]=o[l])};return function(o,l){function r(){this.constructor=o}e(o,l),o.prototype=null===l?Object.create(l):(r.prototype=l.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var wjcGrid=require("wijmo/wijmo.grid"),wjcXlsx=require("wijmo/wijmo.xlsx"),wjcCore=require("wijmo/wijmo"),wjcSelfRef=require("wijmo/wijmo.grid.xlsx"),wjcSelf=wjcSelfRef||exports;window.wijmo=window.wijmo||{},window.wijmo.grid=window.wijmo.grid||{},window.wijmo.grid.xlsx=wjcSelf;var FlexGridXlsxConverter=function(){function e(){}return e.save=function(e,o,l){var r=this._saveFlexGridToWorkbook(e,o);return l&&r.save(l),r},e.saveAsync=function(e,o,l,r,t){var n=this._saveFlexGridToWorkbook(e,o);return n.saveAsync(l,r,t),n},e.load=function(e,o,l){var r=this;if(o instanceof Blob){var t=new FileReader;t.onload=function(){var o=wjcXlsx.Workbook._base64EncArr(new Uint8Array(t.result)),n=new wjcXlsx.Workbook;n.load(o),o=null,e.deferUpdate(function(){r._loadToFlexGrid(e,n,l),n=null})},t.readAsArrayBuffer(o)}else if(o instanceof wjcXlsx.Workbook)e.deferUpdate(function(){r._loadToFlexGrid(e,o,l),o=null});else{if(o instanceof ArrayBuffer)o=wjcXlsx.Workbook._base64EncArr(new Uint8Array(o));else if(!wjcCore.isString(o))throw"Invalid workbook.";var n=new wjcXlsx.Workbook;n.load(o),o=null,e.deferUpdate(function(){r._loadToFlexGrid(e,n,l),n=null})}},e.loadAsync=function(e,o,l,r,t){var n=this;if(o instanceof Blob){var s=new FileReader;s.onload=function(){var o=wjcXlsx.Workbook._base64EncArr(new Uint8Array(s.result)),i=new wjcXlsx.Workbook;i.loadAsync(o,function(t){o=null,i=null,e.deferUpdate(function(){n._loadToFlexGrid(e,t,l),r&&r(t),t=null})},t)},s.readAsArrayBuffer(o)}else if(o instanceof wjcXlsx.Workbook)e.deferUpdate(function(){n._loadToFlexGrid(e,o,l),r&&r(o),o=null});else{if(o instanceof ArrayBuffer)o=wjcXlsx.Workbook._base64EncArr(new Uint8Array(o));else if(!wjcCore.isString(o))throw"Invalid workbook.";(new wjcXlsx.Workbook).loadAsync(o,function(t){o=null,e.deferUpdate(function(){n._loadToFlexGrid(e,t,l),r&&r(t),t=null})},t)}},e._saveFlexGridToWorkbook=function(e,o){var l,r,t,n,s,i,a,c,d,u,w,f,h,p=new wjcXlsx.Workbook,m=new wjcXlsx.WorkSheet,g=(new wjcXlsx.WorkbookStyle,new wjcXlsx.WorkbookFrozenPane),x=!o||null==o.includeColumnHeaders||o.includeColumnHeaders,y=!(!o||null==o.includeRowHeaders)&&o.includeRowHeaders,b=!o||null==o.includeCellStyles||o.includeCellStyles,j=o?o.activeWorksheet:null,_=o?o.includeColumns:null,C=o?o.formatItem:null,v=0,k=0,S=0,W=0,T=[];if(null==this.hasCssText&&(this.hasCssText="cssText"in document.body.style),u=e.wj_sheetInfo,m.name=o?o.sheetName:"",m.visible=!o||!1!==o.sheetVisible,u&&u.tables&&u.tables.length>0)for(var R=0;R<u.tables.length;R++)m.tables.push(u.tables[R]);if(i=[],u||!b&&!C||((w=document.createElement("div")).style.visibility="hidden",w.setAttribute(wjcGrid.FlexGrid._WJS_MEASURE,"true"),e.hostElement.appendChild(w)),y){for(c=0,a=0;a<e.rowHeaders.rows.length;a++)if(!(e.rowHeaders.rows[a].renderSize<=0)){for(i[c]=[],d=0;d<e.rowHeaders.columns.length;d++)t=e._getBindingColumn(e.rowHeaders,a,e.rowHeaders.columns[d]),n=this._getColumnSetting(t,d,e.columnHeaders.columns),i[c][d]=n,0===c&&((s=new wjcXlsx.WorkbookColumn)._deserialize(n),m._addWorkbookColumn(s,d));c++}W=d}if(e.columnHeaders.rows.length>0){for(c=0,a=0;a<e.columnHeaders.rows.length;a++)if(!(e.columnHeaders.rows[a].renderSize<=0)){for(i[c]||(i[c]=[]),d=0;d<e.columnHeaders.columns.length;d++)t=e._getBindingColumn(e.columnHeaders,a,e.columnHeaders.columns[d]),n=this._getColumnSetting(t,d,e.columnHeaders.columns),i[c][W+d]=n,0===c&&(_&&!_(t)||((s=new wjcXlsx.WorkbookColumn)._deserialize(n),m._addWorkbookColumn(s)));x&&(W=0,l={},r=new wjcXlsx.WorkbookRow,y&&(W=this._parseFlexGridRowToSheetRow(e.topLeftCells,l,a,0,i,b,w,T,!1,0,_,C)),this._parseFlexGridRowToSheetRow(e.columnHeaders,l,a,W,i,b,w,T,!1,0,_,C),l.cells.length>0&&(r._deserialize(l),m._addWorkbookRow(r,c))),c++}k=x?c:0}for(a=0;a<e.cells.rows.length;a++)W=0,l={},r=new wjcXlsx.WorkbookRow,(f=e.rows[a])instanceof wjcGrid._NewRowTemplate||((h=f instanceof wjcGrid.GroupRow)?v=wjcCore.tryCast(f,wjcGrid.GroupRow).level:e.rows.maxGroupLevel>-1&&(v=e.rows.maxGroupLevel+1),y&&(W=this._parseFlexGridRowToSheetRow(e.rowHeaders,l,a,0,i,b,w,T,h,v,_,C)),this._parseFlexGridRowToSheetRow(e.cells,l,a,W,i,b,w,T,h,v,_,C),l.cells.length>0&&(r._deserialize(l),m._addWorkbookRow(r,k+a)));for(S=e.cells.rows.length,a=0;a<e.columnFooters.rows.length;a++)W=0,l={},r=new wjcXlsx.WorkbookRow,h=(f=e.columnFooters.rows[a])instanceof wjcGrid.GroupRow,y&&(W=this._parseFlexGridRowToSheetRow(e.rowHeaders,l,a,0,i,b,w,T,h,0,_,C)),this._parseFlexGridRowToSheetRow(e.columnFooters,l,a,W,i,b,w,T,h,0,_,C),l.cells.length>0&&(r._deserialize(l),m._addWorkbookRow(r,k+S+a));return g.rows=x?e.frozenRows+k:e.frozenRows,g.columns=y?e.frozenColumns+W:e.frozenColumns,m.frozenPane=g,p._addWorkSheet(m),u||!b&&!C||(e.hostElement.removeChild(w),T.forEach(function(e){return e.forEach(function(e){e&&e.parentElement&&e.parentElement.removeChild(e)})})),p.activeWorksheet=j,p},e._loadToFlexGrid=function(e,o,l){var r,t,n,s,i,a,c,d,u,w,f,h,p,m,g,x,y,b,j,_,C,v,k,S,W,T,R,X,G,A,F,B,H=!l||null==l.includeColumnHeaders||l.includeColumnHeaders,D=!l||null==l.includeColumnHeaders||l.includeColumnHeaders,N=l&&null!=l.sheetIndex&&!isNaN(l.sheetIndex)?l.sheetIndex:0,E=l?l.sheetName:null,I=!l||l.sheetVisible,z=null!=e.wj_sheetInfo,M=0,L=0,O=!1,P={};if(e.itemsSource=null,e.columns.clear(),e.rows.clear(),e.frozenColumns=0,e.frozenRows=0,T={},R=[],L=0,n=[],X=[],N<0||N>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=E)for(r=0;r<o.sheets.length;r++)if(E===o.sheets[r].name){f=o.sheets[r];break}if(null!=(f=f||o.sheets[N]).rows){for(H&&(L=1,f.rows.length<=1&&(D=!1,L=0),c=f.rows[0]),p=this._getColumnCount(f.rows),h=this._getRowCount(f.rows,p),b=f.summaryBelow,t=f.columns,M=0;M<p;M++)e.columns.push(new wjcGrid.Column),t[M]&&(isNaN(+t[M].width)||(e.columns[M].width=+t[M].width),t[M].visible||null==t[M].visible||(e.columns[M].visible=!!t[M].visible),t[M].style&&t[M].style.wordWrap&&(e.columns[M].wordWrap=t[M].style.wordWrap));for(;L<h;L++){if(m=!1,B=null,w=f.rows[L])for(x=L+1;x<f.rows.length;){if(y=f.rows[x]){(isNaN(w.groupLevel)&&!isNaN(y.groupLevel)||!isNaN(w.groupLevel)&&w.groupLevel<y.groupLevel)&&(m=!0);break}x++}for(m&&!b?(_&&(_.isCollapsed=O),(_=new wjcGrid.GroupRow).isReadOnly=!1,O=null!=w.collapsed&&w.collapsed,_.level=isNaN(w.groupLevel)?0:w.groupLevel,P[_.level]=O,this._checkParentCollapsed(P,_.level)&&_._setFlag(wjcGrid.RowColFlags.ParentCollapsed,!0),e.rows.push(_)):(j=new wjcGrid.Row,w&&this._checkParentCollapsed(P,w.groupLevel)&&j._setFlag(wjcGrid.RowColFlags.ParentCollapsed,!0),e.rows.push(j)),w&&w.height&&!isNaN(w.height)&&(e.rows[D?L-1:L].height=w.height),M=0;M<p;M++)if(w){if(g=w.cells[M],(k=g?g.formula:null)&&"="!==k[0]&&(k="="+k),g&&g.textRuns&&g.textRuns.length>0?(e.rows[D?L-1:L].isContentHtml=!0,e.setCellData(D?L-1:L,M,this._parseTextRunsToHTML(g.textRuns))):e.setCellData(D?L-1:L,M,k&&z?k:this._getItemValue(g)),m||this._setColumn(n,M,g),S=L*p+M,W=g?g.style:null,G=wjcXlsx.Workbook._parseExcelFormat(g),W){if(B=null==B?!!W.wordWrap:B&&!!W.wordWrap,A=this._getItemType(g),W.hAlign)F=wjcXlsx.Workbook._parseHAlignToString(wjcCore.asEnum(W.hAlign,wjcXlsx.HAlign));else switch(A){case wjcCore.DataType.Number:F="right";break;case wjcCore.DataType.Boolean:F="center";break;default:F=G&&0===G.search(/[n,c,p]/i)?"right":"left"}T[S]={fontWeight:W.font&&W.font.bold?"bold":"none",fontStyle:W.font&&W.font.italic?"italic":"none",textDecoration:W.font&&W.font.underline?"underline":"none",textAlign:F,fontFamily:W.font&&W.font.family?W.font.family:"",fontSize:W.font&&W.font.size?W.font.size+"px":"",color:W.font&&W.font.color?W.font.color:"",backgroundColor:W.fill&&W.fill.color?W.fill.color:"",whiteSpace:W.wordWrap?"pre-wrap":"normal",format:G},W.borders&&(W.borders.left&&(this._parseBorderStyle(W.borders.left.style,"Left",T[S]),T[S].borderLeftColor=W.borders.left.color),W.borders.right&&(this._parseBorderStyle(W.borders.right.style,"Right",T[S]),T[S].borderRightColor=W.borders.right.color),W.borders.top&&(this._parseBorderStyle(W.borders.top.style,"Top",T[S]),T[S].borderTopColor=W.borders.top.color),W.borders.bottom&&(this._parseBorderStyle(W.borders.bottom.style,"Bottom",T[S]),T[S].borderBottomColor=W.borders.bottom.color)),W.font&&-1===X.indexOf(W.font.family)&&X.push(W.font.family)}g&&wjcCore.isNumber(g.rowSpan)&&g.rowSpan>0&&wjcCore.isNumber(g.colSpan)&&g.colSpan>0&&(g.rowSpan>1||g.colSpan>1)&&R.push(new wjcGrid.CellRange(L,M,L+g.rowSpan-1,M+g.colSpan-1))}w&&(this._checkParentCollapsed(P,w.groupLevel)||w.visible||null==w.visible||(e.rows[D?L-1:L].visible=w.visible),e.rows[D?L-1:L].wordWrap=!!w.style&&!!w.style.wordWrap||!!B)}for(_&&(_.isCollapsed=O),f.frozenPane&&(C=f.frozenPane.columns,wjcCore.isNumber(C)&&!isNaN(C)&&(e.frozenColumns=C),v=f.frozenPane.rows,wjcCore.isNumber(v)&&!isNaN(v)&&(e.frozenRows=D&&v>0?v-1:v)),M=0;M<e.columnHeaders.columns.length;M++)s=n[M],(i=e.columns[M]).isRequired=!1,D&&(d=c?c.cells[M]:null)&&d.value&&(u=wjcXlsx.Workbook._parseExcelFormat(d),a=wjcCore.Globalize.format(d.value,u)),i.header=a,s&&(s.dataType===wjcCore.DataType.Boolean&&(i.dataType=s.dataType),i.format=s.format,i.align=s.hAlign,i.wordWrap=i.wordWrap||!!s.wordWrap);z&&(e.wj_sheetInfo.name=f.name,e.wj_sheetInfo.visible=!0===I||!1!==f.visible,e.wj_sheetInfo.styledCells=T,e.wj_sheetInfo.mergedRanges=R,e.wj_sheetInfo.fonts=X,e.wj_sheetInfo.tables=f.tables)}},e._parseFlexGridRowToSheetRow=function(e,o,l,r,t,n,s,i,a,c,d,u){var w,f,h,p,m,g,x,y,b,j,_,C,v,k,S,W,T,R,X,G,A,F,B,H,D,N,E,I=!1;for(R=(w=e.grid).wj_sheetInfo,null==(f=e.rows[l]).recordIndex?(F=0,e.cellType===wjcGrid.CellType.ColumnHeader&&e.rows.length>1&&(F=l===t.length?l-1:l)):F=f.recordIndex,o.cells||(o.cells=[]),o.visible=f.isVisible,o.height=f.renderHeight||e.rows.defaultSize,o.groupLevel=c,a&&(o.collapsed=f.isCollapsed),f.wordWrap&&(o.style={wordWrap:f.wordWrap}),(f.constructor===wjcGrid.Row||f.constructor===wjcGrid._NewRowTemplate||tryGetModuleWijmoGridDetail()&&f.constructor===tryGetModuleWijmoGridDetail().DetailRow||tryGetModuleWijmoGridMultirow()&&f.constructor===tryGetModuleWijmoGridMultirow()._MultiRow)&&(I=!0),p=0;p<e.columns.length;p++)if(m=null,T=1,W=1,E=0,A=!1,k=null,D=null,H=null,y=null,G=w._getBindingColumn(e,l,e.columns[p]),S=null,R&&e===w.cells?(v=l*e.columns.length+p,R.mergedRanges&&(S=this._getMergedRange(l,p,R.mergedRanges)),R.styledCells&&(k=R.styledCells[v])):n&&(H=this._getMeasureCell(e,p,s,i),k=(S=w.getMergedRange(e,l,p,!1))?this._getCellStyle(e,H,S.bottomRow,S.rightCol)||{}:this._getCellStyle(e,H,l,p)||{}),S||(S=w.getMergedRange(e,l,p,!1)),S?l===S.topRow&&p===S.leftCol&&(W=S.bottomRow-S.topRow+1,T=this._getColSpan(e,S,d),A=!0):A=!0,!d||d(G)){if(h=t[F]?t[F][p+r]:null,I||a?(x=A?e.getCellData(l,p,!0):null,b=A?e.getCellData(l,p,!1):null,_=!1,x&&wjcCore.isString(x)&&x.length>1&&"="===x[0]&&(_=!0),X=wjcCore.isDate(b),k&&k.format?(m=k.format,/[hsmyt\:]/i.test(m)&&(X=!0),g=wjcXlsx.Workbook._parseCellFormat(k.format,X)):h&&h.style&&h.style.format?(m=G.format,g=h.style.format):g=null,g||(X?g="m/d/yyyy":wjcCore.isNumber(b)&&!G.dataMap?g=wjcCore.isInt(b)?"#,##0":"#,##0.00":_?(C=x.toLowerCase()).indexOf("now()")>-1?(g="m/d/yyyy h:mm",X=!0):C.indexOf("today()")>-1||C.indexOf("date(")>-1?(g="m/d/yyyy",X=!0):C.indexOf("time(")>-1&&(g="h:mm AM/PM",X=!0):g="General")):(x=A?w.columnHeaders.getCellData(0,p,!0):null,g="General"),wjcCore.isString(x)&&-1!==x.indexOf("<span")&&(y=this._parseToTextRuns(x),x=null),D=this._parseCellStyle(k)||{},e===w.cells&&a&&f.hasChildren&&p===w.columns.firstVisibleIndex){if(x?j=x:A&&(j=f.getGroupHeader().replace(/<\/?\w+>/g,"").replace(/&#39;/g,"'")),null==j&&!k)continue;!(X=wjcCore.isDate(j))&&m&&"d"===m.toLowerCase()&&wjcCore.isInt(j)&&(g="0"),j=wjcCore.isString(j)?wjcXlsx.Workbook._unescapeXML(j):j,p===w.columns.firstVisibleIndex&&w.treeIndent&&(E=c),B={value:j,isDate:X,formula:_?this._parseToExcelFormula(x,X):null,colSpan:T,rowSpan:W,style:this._extend(D,{format:g,font:{bold:!0},hAlign:wjcXlsx.HAlign.Left,indent:E}),textRuns:y}}else x=wjcCore.isString(x)?wjcXlsx.Workbook._unescapeXML(x):x,b=wjcCore.isString(b)?wjcXlsx.Workbook._unescapeXML(b):b,!X&&m&&"d"===m.toLowerCase()&&wjcCore.isInt(b)&&(g="0"),N=D&&D.hAlign?D.hAlign:h&&h.style&&null!=h.style.hAlign?wjcCore.asEnum(h.style.hAlign,wjcXlsx.HAlign,!0):wjcCore.isDate(b)?wjcXlsx.HAlign.Left:wjcXlsx.HAlign.General,p!==w.columns.firstVisibleIndex||!w.treeIndent||N!==wjcXlsx.HAlign.Left&&N!==wjcXlsx.HAlign.General||(E=c),B={value:_?null:"General"===g?x:b,isDate:X,formula:_?this._parseToExcelFormula(x,X):null,colSpan:p<w.columns.firstVisibleIndex?1:T,rowSpan:W,style:this._extend(D,{format:g,hAlign:N,vAlign:W>1?e===w.cells||!1===w.centerHeadersVertically?wjcXlsx.VAlign.Top:wjcXlsx.VAlign.Center:null,indent:E}),textRuns:y};u&&u(new XlsxFormatItemEventArgs(e,new wjcGrid.CellRange(l,p),H,s,i,B)),o.cells.push(B)}return r+p},e._parseCellStyle=function(e,o){if(void 0===o&&(o=!1),null==e)return null;var l=e.fontSize;l=l?+l.substring(0,l.indexOf("px")):null,isNaN(l)&&(l=null);var r=e.fontWeight;r="bold"===r||+r>=700;var t="italic"===e.fontStyle,n=e.textDecorationStyle;null==n&&(n=e.textDecoration),n="underline"===n;var s=e.whiteSpace;return s=!!s&&s.indexOf("pre")>-1,{font:{bold:r,italic:t,underline:n,family:this._parseToExcelFontFamily(e.fontFamily),size:l,color:e.color},fill:{color:e.backgroundColor},borders:this._parseBorder(e,o),hAlign:wjcXlsx.Workbook._parseStringToHAlign(e.textAlign),wordWrap:s}},e._parseBorder=function(e,o){var l={};return l.left=this._parseEgdeBorder(e,"Left"),l.right=this._parseEgdeBorder(e,"Right"),l.top=this._parseEgdeBorder(e,"Top"),l.bottom=this._parseEgdeBorder(e,"Bottom"),o&&(l.vertical=this._parseEgdeBorder(e,"Vertical"),l.horizontal=this._parseEgdeBorder(e,"Horizontal")),l},e._parseEgdeBorder=function(e,o){var l,r=e["border"+o+"Style"],t=e["border"+o+"Width"];if(t&&t.length>2&&(t=+t.substring(0,t.length-2)),r&&"none"!==r&&"hidden"!==r){switch(l={},r=r.toLowerCase()){case"dotted":l.style=t>1?wjcXlsx.BorderStyle.MediumDashDotted:wjcXlsx.BorderStyle.Dotted;break;case"dashed":l.style=t>1?wjcXlsx.BorderStyle.MediumDashed:wjcXlsx.BorderStyle.Dashed;break;case"double":l.style=wjcXlsx.BorderStyle.Double;break;default:l.style=t>2?wjcXlsx.BorderStyle.Thick:t>1?wjcXlsx.BorderStyle.Medium:wjcXlsx.BorderStyle.Thin}l.color=e["border"+o+"Color"]}return l},e._parseBorderStyle=function(e,o,l){var r="border"+o+"Style",t="border"+o+"Width";switch(e){case wjcXlsx.BorderStyle.Dotted:case wjcXlsx.BorderStyle.Hair:l[r]="dotted",l[t]="1px";break;case wjcXlsx.BorderStyle.Dashed:case wjcXlsx.BorderStyle.ThinDashDotDotted:case wjcXlsx.BorderStyle.ThinDashDotted:l[r]="dashed",l[t]="1px";break;case wjcXlsx.BorderStyle.MediumDashed:case wjcXlsx.BorderStyle.MediumDashDotDotted:case wjcXlsx.BorderStyle.MediumDashDotted:case wjcXlsx.BorderStyle.SlantedMediumDashDotted:l[r]="dashed",l[t]="2px";break;case wjcXlsx.BorderStyle.Double:l[r]="double",l[t]="3px";break;case wjcXlsx.BorderStyle.Medium:l[r]="solid",l[t]="2px";break;default:l[r]="solid",l[t]="1px"}},e._parseToExcelFontFamily=function(e){var o;return e&&(o=e.split(","))&&o.length>0&&(e=o[0].replace(/\"|\'/g,"")),e},e._parseToExcelFormula=function(e,o){var l,r,t,n,s,i,a,c=/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi,d=/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi,u=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;if(l=e.match(c))for(s=0;s<l.length;s++)a=(i=l[s]).substring(0,i.lastIndexOf(")"))+", 1)",e=e.replace(i,a);if(l=null,l=e.match(d))for(s=0;s<l.length;s++)(r=(i=l[s]).match(u))&&2===r.length&&(t=r[1],/^d{1,4}?$/.test(t)||(n=wjcXlsx.Workbook._parseCellFormat(t,o),a=i.replace(t,n),e=e.replace(i,a)));return e},e._parseToTextRuns=function(e){var o,l,r,t=e.split("<span "),n=[];for(o=0;o<t.length;o++)r=-1!==(l=t[o]).indexOf("</span>")?{text:l.substring(l.indexOf(">")+1,l.indexOf("</span>")),font:this._parseToTextRunFont(l.substring(l.indexOf('style="')+7,l.indexOf(';"')))}:{text:l},n.push(r);return n},e._parseToTextRunFont=function(e){var o,l,r,t,n,s,i,a,c,d=e.split(";");if(d.length>0){for(o=0;o<d.length;o++)if(2===(l=d[o].split(":")).length)switch(l[1]=l[1].trim(),l[0]){case"font-size":s=+l[1].substring(0,l[1].indexOf("px")),isNaN(s)&&(s=null);break;case"font-weight":r="bold"===l[1]||+l[1]>=700;break;case"font-style":t="italic"===l[1];break;case"text-decoration-style":case"text-decoration":n="underline"===l[1];break;case"font-family":i=this._parseToExcelFontFamily(l[1]);break;case"color":a=l[1]}c={bold:r,italic:t,underline:n,family:i,size:s,color:a}}return c},e._getMeasureCell=function(e,o,l,r){var t=r[e.cellType],n=t&&t[o],s=null==n;if(n){if(this.hasCssText){n.style;n.style.cssText="",n.style.visibility="hidden"}}else t||(r[e.cellType]=t=[]),t[o]=n=l.cloneNode();return!s&&n.parentElement||(e.hostElement.children.length>0?e.hostElement.children[0].appendChild(n):e.hostElement.appendChild(n)),n},e._getColumnSetting=function(e,o,l){var r;return r=null!=e.colspan?this._getColumnRenderWidth(o,l):e.renderWidth,r=r||l.defaultSize,{autoWidth:!0,width:r,visible:e.visible,style:{format:e.format?wjcXlsx.Workbook._parseCellFormat(e.format,e.dataType===wjcCore.DataType.Date):"",hAlign:wjcXlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(e.getAlignment())),wordWrap:e.wordWrap}}},e._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e},e._getColumnCount=function(e){for(var o,l=0,r=0,t=0;t<e.length;t++)(o=e[t]&&e[t].cells?e[t].cells:[])&&o.length>0&&(r=o.length,wjcCore.isInt(o[r-1].colSpan)&&o[r-1].colSpan>1&&(r=r+o[r-1].colSpan-1),r>l&&(l=r));return l},e._getRowCount=function(e,o){for(var l,r,t,n=e.length,s=n-1,i=0;i<o;i++)e:for(;s>=0;s--)if(l=e[s],r=l&&l.cells?l.cells:[],(t=r[i])&&(null!=t.value&&""!==t.value||wjcCore.isInt(t.rowSpan)&&t.rowSpan>1)){wjcCore.isInt(t.rowSpan)&&t.rowSpan>1&&s+t.rowSpan>n&&(n=s+t.rowSpan);break e}return n},e._numAlpha=function(e){var o=Math.floor(e/26)-1;return(o>-1?this._numAlpha(o):"")+String.fromCharCode(65+e%26)},e._getItemType=function(e){return null==e||null==e.value||isNaN(e.value)?null:wjcCore.getType(e.value)},e._setColumn=function(e,o,l){var r,t,n,s=e[o];s?(r=this._getItemType(l),s.dataType!==r&&s.dataType===wjcCore.DataType.Boolean&&r!==wjcCore.DataType.Boolean&&(s.dataType=r),l&&null!=l.value&&""!==l.value&&(t=wjcXlsx.Workbook._parseExcelFormat(l))&&s.format!==t&&"General"!==t&&(s.format=t),l&&l.style&&(l.style.hAlign&&(n=wjcXlsx.Workbook._parseHAlignToString(wjcCore.asEnum(l.style.hAlign,wjcXlsx.HAlign))),null==s.wordWrap?s.wordWrap=!!l.style.wordWrap:s.wordWrap=s.wordWrap&&!!l.style.wordWrap),n||r!==wjcCore.DataType.Number||(n="right"),s.hAlign=n):e[o]={dataType:this._getItemType(l),format:wjcXlsx.Workbook._parseExcelFormat(l),hAlign:"",wordWrap:null}},e._getItemValue=function(e){if(null==e||null==e.value)return null;var o=e.value;return wjcCore.isNumber(o)&&isNaN(o)?"":o instanceof Date&&isNaN(o.getTime())?"":o},e._getCellStyle=function(e,o,l,r){try{e.grid.cellFactory.updateCell(e,l,r,o),o.className=o.className.replace("wj-state-selected",""),o.className=o.className.replace("wj-state-multi-selected","")}catch(e){return null}return window.getComputedStyle(o)},e._parseTextRunsToHTML=function(e){var o,l,r,t;for(r="",t=0;t<e.length;t++)r+=(l=(o=e[t]).font)?'<span style="'+(l.bold?"font-weight: bold;":"")+(l.italic?"font-style: italic;":"")+(l.underline?"text-decoration: underline;":"")+(l.family?"font-family: "+l.family+";":"")+(null!=l.size?"font-size: "+l.size+"px;":"")+(l.color?"color: "+l.color+";":"")+'">'+o.text+"</span>":o.text;return r},e._extend=function(e,o){for(var l in o){var r=o[l];wjcCore.isObject(r)&&e[l]?wjcCore.copy(e[l],r):e[l]=r}return e},e._checkParentCollapsed=function(e,o){var l=!1;return Object.keys(e).forEach(function(r){!0===e[r]&&!1===l&&!isNaN(o)&&+r<o&&(l=!0)}),l},e._getColSpan=function(e,o,l){for(var r=0,t=o.leftCol;t<=o.rightCol;t++)l&&!l(e.columns[t])||r++;return r},e._getColumnRenderWidth=function(e,o){var l;return e>=o.length?0:null!=(l=o[e]).renderWidth?l.renderWidth:o.defaultSize},e._getMergedRange=function(e,o,l){var r,t;for(r=0;r<l.length;r++)if(t=l[r],e>=t.topRow&&e<=t.bottomRow&&o>=t.leftCol&&o<=t.rightCol)return t;return null},e}();exports.FlexGridXlsxConverter=FlexGridXlsxConverter;var XlsxFormatItemEventArgs=function(e){function o(o,l,r,t,n,s){var i=e.call(this,o,l)||this;return i._cell=r,i._patternCell=t,i._xlsxCell=s,i._cellsCache=n,i}return __extends(o,e),Object.defineProperty(o.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0}),o.prototype.getFormattedCell=function(){return this._cell||(this._cell=FlexGridXlsxConverter._getMeasureCell(this.panel,this.col,this._patternCell,this._cellsCache),FlexGridXlsxConverter._getCellStyle(this.panel,this._cell,this.row,this.col)),this._cell},o}(wjcGrid.CellRangeEventArgs);exports.XlsxFormatItemEventArgs=XlsxFormatItemEventArgs;